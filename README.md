# Предсказание оттока клиентов телеком-оператора

## Описание проекта

Оператор связи сталкивается с оттоком клиентов и стремится перейти к **проактивному удержанию**.
Цель проекта — построить модель машинного обучения, которая заранее определяет клиентов с высоким риском ухода, чтобы оператор мог предложить им персональные условия, промокоды и специальные тарифы.

Проект охватывает полный цикл Data Science:
- загрузку данных из базы,
- исследовательский анализ,
- feature engineering,
- обучение и сравнение моделей,
- интерпретацию результатов и бизнес-рекомендации.

---

## Цель проекта

Построить модель предсказания оттока клиентов (**churn prediction**) с качеством:

- **ROC-AUC ≥ 0.85 на тестовой выборке**

---

## Итоговые результаты

- Лучшая модель: **XGBoost**
- ROC-AUC на тестовой выборке: **0.9045**
- Accuracy: **0.907**
- Требование по качеству выполнено ✅
- Выявлены ключевые факторы оттока
- Сформированы практические рекомендации для бизнеса

---

## Структура данных

Данные хранятся в SQLite базе `telecom.db` и состоят из 4 таблиц:

### `contract`
Информация о договорах:
- customerID
- BeginDate
- EndDate (`No` — активный договор)
- Type
- PaperlessBilling
- PaymentMethod
- MonthlyCharges
- TotalCharges

### `personal`
Персональные характеристики клиентов:
- gender
- SeniorCitizen
- Partner
- Dependents

### `internet`
Информация об интернет-услугах:
- InternetService
- OnlineSecurity
- OnlineBackup
- DeviceProtection
- TechSupport
- StreamingTV
- StreamingMovies

### `phone`
Информация об услугах телефонии:
- MultipleLines

---

## Целевая переменная

Формируется на основе поля `EndDate`:

- 0 — клиент активен
- 1 — клиент ушел

Доля ушедших клиентов: **~15.7%** (дисбаланс классов).

---

## Используемый стек

- Python 3.11
- uv — управление зависимостями
- pandas, numpy
- scikit-learn
- XGBoost, CatBoost, LightGBM
- matplotlib, seaborn
- phik
- SQLite / SQLAlchemy

---

## Установка и запуск проекта (uv)

### 1. Клонирование репозитория

```bash
git clone https://github.com/your-username/churn-prediction.git
cd churn-prediction
```

### 2. Установка зависимостей

```bash
uv sync
```

### 3. Запуск Jupyter Notebook

```bash
uv run jupyter lab
```

---

## Этапы работы

### 1. Загрузка и первичный анализ данных
- Подключение к SQLite
- Проверка структуры БД
- Анализ типов данных и пропусков

### 2. Исследовательский анализ (EDA)
- Распределения признаков
- Анализ оттока по сегментам
- Корреляционный анализ (phik)

### 3. Объединение данных
- Left join всех таблиц по customerID
- Формирование целевой переменной
- Обработка пропусков

### 4. Feature Engineering
- ContractDuration — длительность контракта
- NumberOfServices — количество подключенных услуг
- Отбор информативных признаков

### 5. Моделирование

Обучены и сравнены модели:
- Decision Tree
- Random Forest
- Logistic Regression
- XGBoost
- CatBoost
- LightGBM

Использовались:
- GridSearchCV / RandomizedSearchCV
- Stratified train/test split
- ROC-AUC как основная метрика

### 6. Анализ результатов
- Оценка на тестовой выборке
- Матрица ошибок
- Precision / Recall
- Feature importance
- Бизнес-интерпретация

---

## Качество лучшей модели

XGBoost (test):

- ROC-AUC: 0.9045
- Accuracy: 0.9073
- Precision: 0.868
- Recall: 0.48

Модель минимизирует ложные срабатывания, но пропускает часть уходящих клиентов — порог классификации можно настраивать под бизнес-задачу.

---

## Ключевые факторы оттока

По важности признаков:
- Длительность контракта
- Наличие нескольких линий
- Наличие партнера
- Количество дополнительных услуг
- Способ оплаты
- Финансовые показатели

Поведенческие признаки оказались важнее финансовых.

---

## Бизнес-инсайты

- Критическая зона риска: 2.5–3 года использования услуг
- Долгосрочные клиенты уходят чаще, чем ожидалось
- Дополнительные услуги повышают удержание
- Клиенты без партнера более склонны к оттоку

---

## Рекомендации

- Проактивное удержание клиентов в зоне риска
- Персонализированные предложения
- A/B тестирование стратегий удержания
- Настройка порога классификации под бизнес-цели
- Регулярное переобучение модели и мониторинг drift

---

## Константы проекта

- RANDOM_STATE = 51125
- TEST_SIZE = 0.25
- DB_PATH = 'telecom.db'

---

## Итог

Построена качественная и интерпретируемая модель предсказания оттока клиентов, готовая к использованию в продакшене и поддержке решений по удержанию.

**Следующий шаг:** пилотный запуск и измерение реального бизнес-эффекта.